Lesson 8\nTroubleshooting Workstation Security Issues\n\nLESSON INTRODUCTION\n\nFor all that you try to configure workstation security according to best practices—securing user accounts, installing antivirus software, updating with patches, and encrypting data—there will be times when those procedures fail to work properly and you have to deal with malware infection. As a CompTIA® A+® PC technician, it is essential that you be able to identify types of malware, the symptoms of malware infections, and the steps to take to remove malicious code and prevent it from re-infecting computers and networks.\ntag: C2 L8

LESSON OBJECTIVES\n\nIn this lesson, you will:\n\n• Detect, remove, and prevent malware infections.\n\n• Troubleshoot common workstation security issues.\ntag: C2 L8

Topic A\nDetect, Remove, and Prevent Malware\n\nEXAM OBJECTIVES COVERED\n\n1002-2.4 Given a scenario, detect, remove, and prevent malware using appropriate tools, and methods.\n1002-3.3 Given a scenario, use best practice procedures for malware removal.\n\nMalware is a catch-all term to describe malicious software threats and social engineering tools designed to vandalize or compromise computer systems. In this, topic, you will learn to describe different malware threats and operate antivirus software to protect the computer against infection and remediate infections.\ntag: C2 L8 TA

COMPUTER VIRUSES AND WORMS\n\nComputer viruses are programs designed to replicate and spread amongst computers. They produce a wide variety of symptoms on a PC and, in extreme cases, can cause permanent damage or loss of files. There are several different types of viruses, and they are generally classified by the different ways they can infect the computer (the vector). For example:\n\n• Boot sector viruses—these attack the boot sector information, the partition table, and sometimes the file system.\n\n• Firmware viruses—these are targeted against the firmware of a specific component, such as the drive controller. Such viruses are often only used in highly directed attacks, as the firmware is specific to particular models of drive, the firmware code is difficult to obtain and compromise, and executing the firmware update without the user realizing it is tricky.\n\n• Program viruses—these are sequences of code that insert themselves into another executable program. When the application is executed, the virus code becomes active.\n\n• Script viruses—scripts are powerful languages used to automate OS functions and add interactivity to web pages. Scripts are executed by an interpreter rather than self-executing. Most script viruses target vulnerabilities in the interpreter.\n\n• Macro viruses—these viruses affect Office documents by using the programming code that underpins macro functionality maliciously.\n\nWhat these types of viruses have in common is that they must infect a host file. That file can be distributed through any normal means—on a disk, on a network, or as an attachment through an email or instant messaging system.\n\nEmail attachment viruses—usually program or macro viruses in an attached file—often use the infected host's electronic address book to spoof the sender's address when replicating. For example, Alice's computer is infected with a virus and has Bob's email address in her address book. When Carlos gets an infected email apparently sent by Bob, it is the virus on Alice's computer that has sent the message.\n\nViruses are also categorized by their virulence. Some viruses are virulent because they exploit a previously unknown system vulnerability—a "zero-day" exploit. Others, employ particularly effective social engineering techniques to persuade users to open the infected file. An infected email attachment with the subject "I Love You" is one of the best examples of the breed.\n\nWhile the distinguishing feature of a virus is its ability to replicate by infecting other computer files, a virus can also be configured with a payload that executes when the virus is activated. The payload can perform any action available to the host process. For example, a boot sector virus might be able to overwrite the existing boot sector, an application might be able to delete, corrupt, or install files, and a script might be able to change system settings or delete or install files.\n\nWORMS\nWorms are memory-resident malware that replicate over network resources. Unlike a virus, a worm is self-contained; that is, it does not need to attach itself to another executable file, They typically target some sort of vulnerability in a network application, such as a database server. The primary effect of a worm infestation is to rapidly consume network bandwidth as the worm replicates. A worm may also be able to crash an operating system or server application (performing a Denial of Service attack). Also, like viruses, worms can carry a payload that may perform some other malicious action (such as installing a backdoor).\ntag: C2 L8 TA

TROJAN HORSES AND SPYWARE\n\nOther types of malware are not classed as viruses as they do not necessarily try to make copies of themselves within another "host" process. They can be just as much of a security threat as viruses, however. A Trojan Horse—or, more simply, just "Trojan"— is a program (usually harmful) that is packaged as something else. For example, you ight download what you think is a new game, but when you run it, it also installs a keylogger and starts sending a transcript of whatever you type to a host on the Internet. There is also the case of rogueware or scareware fake anti-virus, where a web pop-up displays a security alert and claims to have detected viruses on the computer and prompts the user to initiate a full scan, which installs the attacker's Trojan.\n\nMany Trojans function as backdoor applications. Once the Trojan backdoor is installed, it allows the attacker to access the PC, upload files, and install software on it. This could allow the attacker to use the computer in a botnet, to launch Denial of Service (DoS) attacks or mass-mail spam. Trojans are also used by attackers to conceal their actions. Attacks or spam appear to come from the corrupted computer system.\n\nSPYWARE AND KEYLOGGERS\nSpyware is a program that monitors user activity and sends the information to someone else. It may be installed with or without the user's knowledge. Aggressive spyware or Trojans known as "keyloggers" actively attempt to steal confidential information by capturing a credit card number by recording key strokes entered into a web form, for example. Another spyware technique is to spawn browser pop-up windows to try to direct the user to other websites, often of dubious origin.\n\n[file:///fig-444.png]\nActual Keylogger—Windows software that can run in the background to monitor different kinds of computer activity (opening and closing programs, browsing websites, recording keystrokes, and capturing screenshots). (actualkeylogger.com)\n\nNote: Spyware doesn't have to depend on executable programs installed locally. Script ond server-side programs on websites can be used to track a users Internet history through use of cookies and information reported to the site by the browser.\n\nROOTKITS\nMany Trojans cannot conceal their presence entirely and will show up as a running service. Often the service name is configured to be similar to a genuine process to avoid detection. For example, a Trojan may use the filename run32d11 to masquerade as run32d111. One class of backdoor that is harder to detect is the rootkit. A rootkit is a set of tools designed to gain control of a computer without revealing its presence. They are so-called because they execute with root or system-level privileges. The general functions of a rootkit will be as follows:\n\n• Replace key system files and utilities to prevent detection and eradication of the rootkit itself.\n\n• Provide a backdoor channel for the rootkit handler to reconfigure the PC, steal information, or install additional spyware or other malware remotely.\n\n• Evade anti-virus software by infecting firmware code.\n\nRootkits may also be deployed as part of Digital Rights Management (DRM) and copy protection mechanisms. infamously, Sony released a music player for its Extended Copy Protection CDs that also installed a rootkit.\n\nRANSOMWARE\nRansomware is a type of malware that tries to extort money from the victim. One class of ransomware will display threatening messages, such as requiring Windows® to be reactivated or suggesting that the computer has been locked by the police because itwas used to view child pornography or for terrorism. This may block access to the computer by installing a different shell program but this sort of attack is usually relatively trivial to fix. Another class of ransomware attempts to encrypt data files on any fixed, removable, and network drives. Ifthe attack is successful, the user will be unable to access the files without obtaining the private encryption key, which is held by the attacker. If successful, this sort of attack is extremely difficult to mitigate, unless the user has up-to-date backups of the encrypted files.\n\n[file:///fig-445.png]\nWannaCry ransomware. Wikimedia Public Domain image.\n\nNote: Most ransomware wil be capable of encrypting removable drives too so backup devices should not be left attached routinely. A cloud-based backup might offer a better alternative, but ifthe credentials for the cloud file server are cached, the ransomware is likely to be able to encrypt those, too.\n\nRansomware uses payment methods such as wire transfer, Bitcoin, or premium rate phone lines to allow the attacker to extort money without revealing his or her identity or being traced by local law enforcement.\ntag: C2 L8 TA

SOURCES OF MALWARE INFECTION\n\nThere are numerous sources of malware infection, but the main ones are:\n\n• Visiting "unsavory" websites with an unpatched browser, low security settings, and no anti-virus software.\n\n• Opening links in unsolicited email.\n\n• Infection from another compromised machine on the same network.\n\n• Executing a file of unknown ori attachments are still the most popular vector, but others include file sharing sites, websites generally, attachments sent via chat/instant Messaging, AutoRun USB sticks and CDs, and so on.\n\n• Becoming victim to a "zero-day" exploit (that is, some infection mechanism that is unknown to software and anti-virus vendors).\ntag: C2 L8 TA

ANTIVIRUS SOFTWARE\n\nAntivirus software (A-V) uses a database of known virus patterns (definitions) plus heuristic malware identification techniques to try to identify infected files and prevent viruses from spreading, "Heuristic" means that the software uses knowledge of the sort of things that viruses do to try to spot (and block) virus-like behavior.\n\nTypically, the software is configured to run automatically when a user or system process accesses a file. The antivirus software scans the file first and blocks access if it detects anything suspicious.\n\nThe user can then decide either to try to disinfect the file, quarantine it (block further access), or delete it. Another option might be for the user to ignore the alert (if it is. deemed a false positive, for instance) and exclude the file from future scans.\n\nThe A-V scanner also runs at boot-time to prevent boot sector viruses from infecting the computer, Most types of software can also scan system memory (to detect worms), email file attachments, removable drives, and network drives.\n\nThe latest "antivirus" software is usually "anti-malware" software, and includes routines and signatures to detect and block Trojans, rootkits, ransomware, and spyware.\n\n[file:///fig-446.png]\nSymantec Endpoint Protection malicious software protection.\n\nAntivirus software can be purchased either as personal security suites, designed to protect a single host, or network security suites, designed to be centrally managed from a server console, Most antivirus software is designed for Windows PCs and networks, as these are the systems targeted by most virus writers, but software is available for Linux® and macOS* as well.\n\nSome of the major vendors are Symantec™ (including the Norton™ brand), McAfee®, Trend Micro", Kaspersky”, ESET" (NOD32"), and Bitdefender.\n\nAntivirus updates must be managed as they are made available. Antivirus engine updates can include enhancements, bug fixes, or new features being added to the software engine, improving the manner in which the software operates. Updates can be implemented automatically or manually depending on the software. Automatic updating refers to software that periodically downloads and applies updates without any user intervention, whereas manual updating means that a user must be involved\n\nto either initiate the update, download the update, or at least approve installation of\nthe update.\ntag: C2 L8 TA

BEST PRACTICES FOR MALWARE REMOVAL\n\nCompTIA has identified a seven-step best practice procedure for malware removal:\n\n1. Identify and research malware symptoms.\n\n2. Quarantine infected systems.\n\n3. Disable System Restore (in Windows).\n\n4. Remediate infected systems:\n• Update anti-malware software.\n• Scan and use removal techniques (Safe Mode, Pre-installation environment)\n\n5. Schedule scans and run updates.\n\n6. Enable System Restore and create restore point (in Windows).\n\n7. Educate end user.\n\nThese steps are explained in more detail in the remainder of this topic.\ntag: C2 L8 TA

MALWARE RESEARCH\n\nThere are several websites dedicated to investigating the various new attacks that are developed against computer systems. Apart from the regular IT magazines, some good, examples include cert.org, sans.org, schneier.com, and grc.com. The SANS "Top 20" critical security controls is one of the most useful starting points (sans.org/top20/). Antivirus vendors also maintain malware encyclopedias ("bestiaries") with complete information about the type, symptoms, purpose, and removal of viruses, worms, Trojans, and rootkits.\n\n[file:///fig-447.png]\nSymantec's Security Response portal showing current threat status, recent viruses and vulnerabilities, and search options for the malware database.\ntag: C2 L8 TA

QUARANTINE AND REMEDIATION OF INFECTED SYSTEMS\n\nFollowing the seven-step procedure, if symptoms of a malware infection are detected, the next steps should be to apply a quarantine, disable System Restore, and then remediate the infected system.\n\nQUARANTINING INFECTED SYSTEMS\nMalware such as worms propagate over networks. This means that one of the first actions should be to disconnect the network link. Infected files could have been uploaded to network servers or cloud services, though these systems should have server-side scanning software to block infected files.\n\nMove the infected system to a physically or logically secure work area. To remediate the system, you might need network access to tools and resources but you cannot risk infecting the production network. You should also ensure that the infected computer is not used until it has been cleaned up.\n\nOnce the infected system is isolated, the next step is to disable System Restore and other automated backup systems, such as File History. If you are relying on a backup to recover files infected by malware, you have to consider the possibility that the backups are infected, too. The safest option is to delete old system restore points and backup copies, but if you need to retain them, try to use antivirus software to determine whether they are infected.\n\nAlso consider identifying and scanning any removable media that has been attached to the computer. If the virus was introduced via USB stick, you need to find it and remove it from use. Viruses could also have infected files on any removable media attached to the system while it was infected.\n\nThe main tool to use to try to remediate an infected system will be antivirus software, though if the software has not detected the virus in the first place, you are likely to have to use a different suite. Make sure the antivirus software is fully updated before proceeding, This may be difficult if the system is infected, however. It may be necessary to remove the disk and scan it from a different system.\n\nREMEDIATING INFECTED SYSTEMS\nIf a file is infected with a virus, you can (hopefully) use antivirus software to try to remove the infection (cleaning), quarantine the file (the antivirus software blocks any attempt to open it), or erase the file. You might also choose to ignore a reported threat, if it is a false positive, for instance. You can configure the action that software should attempt when it discovers malware as part of a scan.\n\n[file:///fig-448.png]\nConfiguring scan remediation options.\n\nMost of the time the software will detect the virus and take the appropriate action. If you cannot clean a file, and have a backup copy, use it to restore the file. Check the files you restore to make sure that your backups are not infected.\n\n[file:///fig-449.png]\nDetecting and remediating a virus infection.\n\nAnother option is to remove the virus manually. For assistance, check the website and support services for your anti-virus software. In some cases, you may have to follow a further procedure to remove the virus or Trojan Horse:\n\n• Use Task Manager or taskki11 to terminate suspicious processes.\n\n• Execute commands at a command prompt terminal and/or manually remove registry items using regedit.\n\n• Use msconfig to perform a safe boot or boot into Safe Mode, hopefully preventing any infected code from running at startup.\n\n• Boot the computer using the product disk and use the Windows Recovery Environment (WinRE) to run commands from a "clean" command environment. Another option, as mentioned previously, is to remove the disk from the infected\nsystem and scan it from another system, taking care not to allow cross-infection.\n\nNote: The CompTIA exam objectives mention the recovery console. This is a precursor to WinkE, used by the Windows 2000 and Windows XP versions. Recovery console presents a limited subset of the commands normally available at a Windows command prompt and does not provide as many tools as WinkE.\n\nAntivirus software will not necessarily be able to recover data from infected files. Also, if virus does disrupt the computer system, you might not be able to run antivirus software anyway and would have to perform a complete system restore. This involves reformatting the disk, reinstalling the OS and software (possibly from a system image snapshot backup), and restoring data files from a (clean) backup.\n\nNote: Windows 8 and Windows 10 support a "refresh" reinstallation mode that wipes desktop applications but preserves user data files, personalization settings, and Windows Store apps. This might be of use in removing malware.\ntag: C2 L8 TA

MALWARE INFECTION PREVENTION\n\nOnce a system has been cleaned, you need to take the appropriate steps to prevent re- infection.\n\nCONFIGURING ON-ACCESS SCANNING\nAlmost all security software is now configured to scan on-access. On-access means that the A-V software intercepts an OS call to open a file and scans the file before allowing or preventing it from being opened. This reduces performance somewhat but is essential to maintaining effective protection against malware.\n\nNote: When configuring antivirus software, it is vital to configure the proper exceptions. Real-time scanning of some system files and folders (notably those used by Windows Update) can cause serious performance problems.\n\n[file:///fig-450.png]\nConfiguring Fle System Auto-Protect on-access scans.\n\nNote: Antivirus software depends on services to run properly—make sure that these are not disabled.\n\nCONFIGURING SCHEDULED SCANS\nAll security software supports scheduled scans. These scans can impact performance, however, so it is best to run them when the computer is otherwise unused. Symantec Endpoint Protection performs an "Active Scan” at startup, but the user can define any type of scan to run to a schedule of their own choosing.\n\nYou also need to configure the security software to perform malware pattern and antivirus engine updates regularly.\n\n[file:///fig-451.png] \nConfiguring a scheduled scan.\n\nDNS CONFIGURATION\nDNS spoofing allows attackers to direct victims away from the legitimate sites they were intending to visit and towards fake sites. As part of preventing reinfection, you should inspect and re-secure the DNS configuration.\n\n• Flush the local DNS cache to clear out any potentially malicious entries. In Windows, you can usei pconfig / fl ushdns to do this.\n\n• Check the HOSTS file for spoofed entries—mappings in the HOSTS file are loaded into the DNS cache and can override other name resolution methods, depending on how the system is configured. Malware often tries to corrupt the file to insert malicious entries. In Windows, the file is stored in %SYSTEMROOT% \system32\drivers\etc\hosts. In Linux, it is located in /ete/hosts. These files should generally be empty, though there may be commented (#) text.\n\n• In Windows, check the priority order for name resolution services is set as per network policies. The priority order is set in the registry key HKLM SYSTEM→CurrentControlSet→Services Tcpip→ServiceProvider.\n\n• Validate the DNS resolvers set as primary and secondary in the client's IP configuration (use i pconfig /al |).\n\n• Check these local DNS resolver services to make sure they are operating normally and are configured according to policy. You may also want to flush the cache on these servers. You could also test name resolution with nS! ookup to compare results of queries performed by your local DNS infrastructure with results obtained from a trusted Internet DNS provider. Google's public DNS servers (8.8.8.8 and 8.8.4.4) are quite widely used, for instance. Another option is Quad9, sponsored by IBM. Quad9 has a special focus on blocking domains known to host malicious content. There is a filtered service (9.9.9.9 and 149.112.112.112) and a non-secured service (9.99.10 and 149.112.112.10).\n\n• Check that where you are forwarding queries, these queries are being sent to legitimate DNS servers on the Internet. Most organizations use their ISP's servers. Ensure that queries are reaching the intended servers and are not being redirected to arogue DNS.\n\nSOFTWARE FIREWALLS\nIf malware was able to run with administrative privileges, it may have made changes to the software (host) firewall configuration. An unauthorized port could potentially facilitate reinfection of the machine. You should inspect the firewall policy to see if there are any unauthorized changes. Consider resetting the policy to the default.\n\nENABLING SYSTEM RESTORE\nIf you disabled System Restore and automatic backups, you should re-enable them as part of the recommissioning process. Create a fresh restore point or system image and a clean data backup. As a final step, complete another antivirus scan; if the system is clean, then remove the quarantine and return it to service.\ntag: C2 L8 TA

GUIDELINES FOR REDUCING MALWARE EFFECTS\n\nConsider the following guidelines to help reduce the effects of malware.\n\nREDUCE THE RISK AND IMPACT OF MALWARE\nSeveral steps can be taken to reduce the risk and impact of malware:\n\n• Carry out regular backups that allow data to be recovered, in case of loss due to a virus infection. Do not leave the backup device attached to the host. This minimizes the risk of the backup files becoming infected.\n\n• Apply operating system and application security patches.\n\n• Do not allow users to bring in their own software programs. If necessary, measures such as removing (or disabling) removable drives can be used. Windows-based systems also allow the administrator to determine who can run new programs, install new software, or download files from the web. Use these rights effectively.\n\n• Install and use an anti-virus package. The virus package must be kept up-to-date with updated signatures (or definitions), since viruses are continually being developed and the latest signatures offer the most protection.\n\n• Select antivirus software that scans automatically (on-access). This provides much more reliable protection against web and email attachment threats.\n\n• Configure filtering on the messaging server—this will prevent most of the unsolicited messages (spam) arriving at the server from getting to the users’ mailboxes.\n\n• Do not log on with administrative privileges except where necessary. Limit administrative privileges to a few, Selected accounts. Keep passwords for these accounts secure.\n\n• Educate users about not running attachments—and supplement this with procedures that will prevent files, such as executables and Office macros, from being allowed to run. This could be accomplished (for instance) by only allowing digitally signed code to be executed.\n\n• Audit system events (such as logons) and review logs for unusual activity.\n\n• Establish a procedure for recovery following virus infection to minimize the spread and effect of a virus.\n\nRoutine procedures, such as applying critical and security patches to the OS and  applications and updating virus definitions and malware threats in antivirus software, should be automated where possible or performed according to a strict schedule. Try to find time to monitor security developments so that you are aware of new threat types and strategies or "zero-day" vulnerabilities (flaws that have not been fixed by a patch).\n\nTraining and educating users can be more problematic. You may well have to overcome resistance to end users accepting responsibility for security. The efforts of a single support technician are unlikely to make much difference. An organization needs to develop and enforce effective policies, backed up by disciplinary procedures to supplement training and education programs.\ntag: C2 L8 TA

Activity 8-1\nDiscussing Detecting, Removing, and Preventing Malware Infections\n\nSCENARIO\nAnswer the following questions to check your understanding of the topic.\n\n1. What are the principal characteristics of Trojan malware?\n\n2. What general class of malware is crypto-malware an example of?\n\n3. Why might you need to use a virus encyclopedia?\n\n4. Why must antivirus software be kept up-to-date regularly?\n\n5. What type of file scan offers best protection for ordinary users?\n\n6. What would be the purpose of quarantining an infected file, rather than deleting it?\n\n7. Why is DNS configuration a step in the malware remediation process?\n\n8. What sort of training should you give to end users to reduce the risk of infections?\ntag: C2 L8 TA A8-1

Topic B\nTroubleshoot Common Workstation Security Issues\n\nEXAM OBJECTIVES COVERED\n1002-2.2 Explain logical security concepts.\n1002-3.2 Given a scenario, troubleshoot and resolve PC security issues.\n\nAs with many areas of computer support, your responsibility for computer security does not end as soon as the security measures are implemented. As with printing, networking, hardware, and software, it is your responsibility to your users and clients. to ensure proper security functions on an ongoing basis as well as to correct security problems that might compromise your systems or prevent users from accessing the resources that they need. The information and skills in this topic should help you troubleshoot any security issues that arise and restore your organization's security functions.\ntag: C2 L8 TB

COMMON SYMPTOMS OF MALWARE INFECTION\n\nA virus's payload can be programmed to perform many different actions and there are, besides, many different types of malware. Consequently, there can be very many different symptoms of malware infection.\n\nPERFORMANCE SYMPTOMS\nWhen the computer is slow or "behaving oddly,” one of the things you should suspect is malware infection. Some specific symptoms associated with malware include:\n\n• The computer fails to boot or experiences lock ups.\n\n• Unexpected or threatening messages or graphics appear on the screen.\n\n• Performance at startup or generally is very slow.\n\n• Network performance is slow or Internet connections are disrupted.\n\nAny sort of activity or configuration change that was not initiated by the user is a good reason to suspect malware infection. Of course, all these things can have other causes, too. If you identify these symptoms, run an antivirus scan. If this is negative but you cannot diagnose another cause, consider quarantining the system or at least putting it under close monitoring.\n\nNote: If a system is “under suspicion," do not allow users with administrative privileges to sign in to it, either locally or remotely. This reduces the risk that malware could compromise a privileged account.\n\nAPPLICATION CRASHES AND SERVICE PROBLEMS\nOne of the key indicators of malware infection is that security-related applications, such as antivirus, firewall, and Windows Update, stop working. You might also notice that applications or Windows tools (Notepad for instance) stop working or crash frequently.\n\nSoftware other than Windows is often equally attractive for malware writers as not all companies are diligent in terms of secure coding. Software that uses browser plug-ins is often targeted; examples include Adobe's Reader® software for PDFs and Flash Player. If software from a reputable vendor starts crashing (faulting) repeatedly, suspect malware infection and apply the quarantining/monitoring procedures described earlier.\n\nFILE SYSTEM ERRORS AND ANOMALIES\nAnother “red flag" for malware infection is changes to system files and/or file permissions.\n\n• The file system or individual files are corrupted or deleted.\n\n• Date stamps and file sizes of infected files change.\n\n• Permissions attributes of files change, resulting in "Access Denied” errors.\n\n• New executable files (EXEs and DLLs) appear in system folders. They may have file names that are very close to valid programs (notpad.exe).\n\nThese sorts of issues are less likely to have other causes so you should quarantine the system and investigate it closely.\n\nEVENT VIEWER\nThe system, application, and security logs may be of use in detecting malware that is attempting to remain concealed. You can inspect these log files using Event Viewer. High numbers of audit failures in the security log or unexpected Windows Installer events are the types of thing that warrant further investigation. The log will also list application and service crash events, which may reveal some sort of malware infection.\ntag: C2 L8 TB

WEB BROWSER SECURITY ISSUES\n\nMalware often targets the web browser. Remember that malware is not always destructive. Malware such as adware and spyware is designed with commercial or criminal intent rather than to vandalize the computer system.\n\nCommon symptoms of infection by spyware or adware are pop-ups or additional toolbars, the home page or search provider changing suddenly, searches returning results that are different to other computers, slow performance, and excessive crashing (faults). Viruses and Trojans may spawn pop-ups without the user opening the browser.\n\nNote: The lines between useful utilities, adware, and spyware are not completely clear-cut, but if something is there that the user (or IT department) did not explicitly sanction, then it's best to get rid of it.\n\nAnother symptom is redirection. This is where the user tries to open one page but gets sent to another. Often this may imitate the target page. In adware, this is just a blunt means of driving traffic through a site, but spyware may exploit it to capture authentication details.\n\nNote: If a user experiences redirection, check the HOSTS file for malicious entries. HOSTS is a legacy means of mapping domain names to IP addresses and is a popular target for malware. Also verify which DNS servers the client is configured to use.\n\nTROJANS, ROOTKITS, AND BOTNETS\nMalware that tries to compromise the PC will try to create a communications channel with its "handler." If the firewall is still working, you may see unfamiliar processes or ports trying to connect to the Internet.\n\nNote: Remember that the most powerful malware can disguise its presence. For example, the netstat utility shows ports open on the PC. A rootkit may replace netstat with a modified version that does not show the ports in use by the rootkit.\n\nOne use of Trojans and rootkits is to scan other hosts for weaknesses and launch Denial of Service (DoS) attacks against networks. Most ISPs monitor the use of scanning tools and will warn you if they detect their use coming from your IP address.\n\nNote: Trojans and rootkits are likely to try to disguise their presence. New breeds of rootkit try to occupy firmware, for instance, so that not even disinfecting the file system or re-formatting the hard drive will remove them. Sometimes the only way to diagnose such infections is to examine network traffic from the infected PC from a different machine.\n\nVIRUS ALERT HOAXES AND ROGUE ANTIVIRUS\nHoax virus alerts are quite common. They are often sent as mass emails as a prank. Most advise you to forward the “alert” to everyone in your address book. Some hoax Virus alerts describe a number of steps that you "must take" to remove the virus— following these steps may cause damage to your computer. Use legitimate portals to research malware.\n\nRogue antivirus is a particularly popular way to disguise a Trojan. In the early versions of this attack, a website would display a pop-up disguised as a normal Windows dialog, box with a fake security alert, warning the user that viruses have been detected. AS browsers and security software have moved to block this vector, cold calling vulnerable users claiming to represent Microsoft support has become a popular attack.\ntag: C2 L8 TB

DIGITAL CERTIFICATE ISSUES\n\nWebsites and program code are very often made trustworthy by proving the site or code author's identity using a digital certificate. The certificate is a wrapper for the public key in a public/private key pair. The public key enables a client to read the certificate holder's signature, created using an encryption mechanism. As that signature could only have been made with the linked private key, and the private key should be known only to the holder, if the user trusts the certificate, then the user can trust the website or program code.\n\nThe issue then is how the user is able to trust the certificate. Most certificates are issued and vouched for by a third-party called a Certificate Authority (CA). The CA adds its own signature to the site certificate. The user can validate the CA's signature, because the CA's root certificate is installed on the computer.\n\nRoot certificates have to be trusted implicitly, so it would obviously be highly advantageous if a malicious user could install a bogus root certificate and become a trusted root CA. Installing a trusted root certificate usually requires administrative privileges. On a Windows PC, most root certificate updates are performed as part of Windows Update or installed by domain controllers or administrators as part of running Active Directory. There have been instances of stolen certificates and root, certificates from CAs being exploited because of weaknesses in the key used in the certificate.\n\nWhen you browse a site using a certificate, the browser displays the information about the certificate in the address bar:\n\n• If the certificate is valid and trusted, a padlock icon is shown. Click the icon to view information about the certificate and the Certificate Authority guaranteeing it.\n\n[file:///fig-463a.png]\nBrowsing a secure site: 1) Check the domain name as highlighted in the address bar; 2) Only enter confidential data into a site using a trusted certificate: 3) Click the padlock to view information about the certificate holder and the CA that issued it and optionally to view the certificate itself.\n\n• If the certificate is highly trusted, the address bar is colored green. High assurance certificates make the website owner go through an even more rigorous identity validation procedure.\n\n• If the certificate is untrusted or otherwise invalid, the address bar might show a color-coded alert and the site is blocked by a warning message. If you want to trust the site anyway, click through the warning.\n\n[file:///fig-463b.png]\nUntrusted certificate warning. (Screenshot used with permission from Microsoft)\n\nNote: Digital certificates are also used to verify the identity of software publishers. if a certificate has not been issued by a one of the trusted root CAs, Windows will warn you that the publisher cannot be verified when you try to install an add-on or other type of application.\ntag: C2 L8 TB

EMAIL ISSUES\n\nSpam is unsolicited email messages, the content of which is usually advertising pornography, miracle cures for various personal conditions, or bogus stock market tips, and investments. Spam is also used to launch phishing attacks and spread viruses and worms. Spam needs to be filtered before it reaches the user's inbox. Most email applications now ship with junk mail filters or you can install a filter at the organization's mail gateway. These filters need to be kept up-to-date in order to protect against the latest spamming techniques.\n\nNote: Host-based spam filters are fine for home users but enterprise networks will usually deploy a mail gateway to filter spam and scan message for malware before it reaches the company's internal mail servers.\n\nif the filter tags a message as spam, it posts it to a "Junk" email folder and no notification is displayed to the user. The user can inspect the junk folder manually to retrieve any legitimate messages that have been blocked by accident (false positives). The main problem with email filtering is that it can block genuine messages too, leading to missed communications. Some filters may support detection levels so that where the scan is not certain the message is spam, it may hold it and send a blocked notification to the user's inbox.\n\nAs well as detecting spam automatically, these tools allow the user to blacklist known. spammer domains or to whitelist known safe senders.\n\nEmail file attachments are frequently used as a vector for malware. As well as deploying filtering to detect such messages as spam, most A-V software can scan message attachments for malware before they can be opened.\n\nIn addition to being a vector for infection, spam may be a symptom of malware infection. One of the main criminal uses of Trojans is to install spamming software on the "zombie" PC. The software starts sending out spam emails. The software may do this surreptitiously to avoid detection; that is, it does not try to send thousands of messages at a time, but a few messages every hour. Because the Trojan may have infected thousands or millions of PCs (a botnet), it is capable of delivering huge quantities of spam.\n\nIf a computer's email is hijacked in this way, the user is likely to receive bounces, non-deliverable messages, automated replies from unknown recipients, or messages from users regarding the spam that has been sent. This does not always indicate malware infection, however; it could simply be that the spammer has spoofed the user's email address. If the volume is large, they may receive complaints from other networks and from their ISP. You can use various websites—mxtoolbox.com is one example—to check whether your organization's public IP address appears on any blacklist.\ntag: C2 L8 TB

GUIDELINES FOR TROUBLESHOOTING COMMON WORKSTATION SECURITY ISSUES\n\nConsider the following guidelines when troubleshooting common workstation security issues.\n\nTROUBLESHOOT COMMON WORKSTATION SECURITY ISSUES\nFollow these guidelines for troubleshooting common workstation security issues.\n\n• Symptoms of malware infection might include:\n\n• Performance issues such as failure to boot, lock ups, slow performance, or strange messages or images on screen.\n\n• Frequent application crashes and service problems.\n\n• Changes to system files or changes to file permissions.\n\n• Event log entries showing a high number of audit failures or application and service crash events.\n\n• Web browsers are frequent targets for malware delivery.\no May be adware or spyware,\no Might redirect users to a site that imitates the site the user attempted to access.\no As compromised PC attempts to communicate with handler, unfamiliar processes or ports show up in firewall log files.\no Hoax virus alerts requesting users to forward the message, or messages including steps to remove the virus with the steps doing the actual damage.\no Rogue antivirus disguises Trojans.\n\n• Check for compromised CAs.\n\n• Verify the padlock icon is shown in browsers for secure sites and that the address. bar is not maroon, which would indicate an untrusted, insecure site.\n\n• Check the Junk email folder to ensure legitimate emails are not improperly flagged,\n\n• Make sure users understand the potential issues in running email file attachments.\ntag: C2 L8 TB

Activity 8-3\n\nDiscussing Troubleshooting Common Workstation Security Issues\n\nSCENARIO\n\nAnswer the following questions to check your understanding of the topic.\n\n1. Early in the day, a user called the help desk saying that his computer is running slowly and freezing up. Shortly after this user called, other help desk technicians who overheard your call also received calls from users who report similar symptoms.  Is this likely to be a malware infection? If so, what type of malware would you suspect?\n\n2. Why might a PC infected with malware display no obvious symptoms?\n\n3. You receive a support call from a user who is "stuck" on a web page. She is trying to use the Back button to return to her search results, but the page just displays again with a pop-up message.  Is her computer infected with malware?\n\n4. Another user calls to say he is trying to sign on to his online banking service, but the browser reports that the certificate is invalid.  Should the bank update its certificate, or do you suspect another cause?\n\n5. Your company’s static IP address has been placed on a number of anti-spam blacklists.  Could this be the result of external fraud or do you need to investigate your internal systems for malware?\ntag: C2 L8 TB A8-3

Summary\n\nIn this lesson, you performed troubleshooting on workstation security issues such as malware, web browser and digital certificate issues, and email issues. In your role as an A+ technician, you will be advising and supporting users in multiple areas surrounding computing devices, so using the guidelines and procedures provided in this lesson will enable you to provide the required level of support to users.\n\nWhich best practice for minimizing the effect of malware do you think is most important?\n\nHow might you recognize a possible spyware or adware infection on a workstation?\ntag: C2 L8 SUMMARY
